<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>TERMINAL_ROOT // SYSTEM_BREACH_DETECTED</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Fira+Code:wght@300;500&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           SCIENTIFIC CYBERPUNK CSS FRAMEWORK
           ========================================= */
        :root {
            --primary: #00ff41;
            --primary-dim: #003b00;
            --danger: #ff003c;
            --danger-dim: #440010;
            --warning: #ffaa00;
            --bg: #030303;
            --crt-green: rgba(18, 255, 16, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; cursor: crosshair; }

        body {
            background: var(--bg);
            color: var(--primary);
            font-family: 'Share Tech Mono', monospace;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- ADVANCED CRT EFFECTS --- */
        #crt-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10000;
            background: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 3px, 3px 100%;
        }

        #vignette {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            box-shadow: inset 0 0 200px rgba(0,0,0,0.9);
            pointer-events: none;
            z-index: 10001;
        }

        /* --- GRID SYSTEM --- */
        #grid-container {
            display: grid;
            grid-template-columns: 350px 1fr 380px;
            grid-template-rows: 40px 1fr 200px 30px;
            height: 100vh;
            gap: 10px;
            padding: 10px;
            background: radial-gradient(circle at center, #0a1a0a 0%, #000 100%);
        }

        .panel {
            background: rgba(0, 5, 0, 0.9);
            border: 1px solid var(--primary-dim);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(2px);
        }

        .panel-header {
            background: var(--primary-dim);
            color: var(--primary);
            padding: 3px 10px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            border-bottom: 1px solid var(--primary);
        }

        /* --- MODULES SPÉCIFIQUES --- */
        header { grid-column: 1 / 4; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 1px solid var(--primary); }
        
        #left-stack { grid-row: 2 / 4; display: flex; flex-direction: column; gap: 10px; }
        
        #main-terminal { 
            grid-column: 2 / 3; 
            grid-row: 2 / 3; 
            display: flex; 
            flex-direction: column; 
            border: 1px solid var(--primary);
        }

        #terminal-output {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.4;
            scrollbar-width: none;
        }

        .input-line {
            display: flex;
            padding: 10px 20px;
            background: rgba(0, 40, 0, 0.2);
            border-top: 1px solid var(--primary-dim);
        }

        #cmd-input {
            background: transparent;
            border: none;
            color: var(--primary);
            font-family: 'Fira Code', monospace;
            font-size: 16px;
            width: 100%;
            outline: none;
            margin-left: 10px;
        }

        /* --- RADAR ET VISUELS --- */
        #radar-panel { height: 300px; }
        #radar-canvas { width: 100%; height: 100%; }

        #visual-feed { grid-column: 3 / 4; grid-row: 2 / 4; display: flex; flex-direction: column; gap: 10px; }
        
        .camera-box {
            height: 250px;
            background: #000;
            position: relative;
            border: 1px solid var(--danger);
        }
        
        #webcam {
            width: 100%; height: 100%; object-fit: cover;
            filter: grayscale(1) contrast(1.5) brightness(0.7) sepia(1) hue-rotate(80deg);
            opacity: 0.6;
        }

        /* --- ANIMATIONS DE "PEUR" --- */
        .glitch-flash {
            animation: flash 0.1s steps(2) infinite;
        }

        @keyframes flash {
            0% { background: var(--bg); }
            50% { background: var(--danger-dim); }
        }

        .warning-text { color: var(--danger); animation: blink 0.5s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* --- SCROLLING LOGS (MATRIX STYLE) --- */
        #log-matrix {
            height: 100%;
            font-size: 10px;
            color: var(--primary-dim);
            overflow: hidden;
            line-height: 1;
        }

        footer { grid-column: 1 / 4; border-top: 1px solid var(--primary-dim); display: flex; justify-content: space-between; font-size: 10px; padding: 0 10px; align-items: center; }

    </style>
</head>
<body>

<div id="crt-screen"></div>
<div id="vignette"></div>

<div id="grid-container">
    <header class="panel">
        <div><span class="warning-text">●</span> NODE_STABILITY: CRITICAL</div>
        <div id="sys-title">FSOCIETY_DEDICATED_TERMINAL_V5.01</div>
        <div id="clock">00:00:00:00</div>
    </header>

    <div id="left-stack">
        <div class="panel" style="flex-grow: 1;">
            <div class="panel-header"><span>NETWORK_TRAFFIC</span><span>LIVE</span></div>
            <div id="log-matrix"></div>
        </div>
        <div class="panel" id="radar-panel">
            <div class="panel-header"><span>GEOLOC_RADAR</span><span>SCANNING...</span></div>
            <canvas id="radar-canvas"></canvas>
        </div>
    </div>

    <div id="main-terminal" class="panel">
        <div class="panel-header"><span>SYSTEM_CONSOLE</span><span>ROOT_ACCESS</span></div>
        <div id="terminal-output"></div>
        <div class="input-line">
            <span>root@fsociety:~#</span>
            <input type="text" id="cmd-input" spellcheck="false" autofocus>
        </div>
    </div>

    <div id="visual-feed">
        <div class="panel camera-box">
            <div class="panel-header"><span>FACIAL_RECOGNITION</span><span style="color:var(--danger)">LOCKED</span></div>
            <video id="webcam" autoplay muted></video>
            <div id="target-ui" style="position:absolute; inset:0; border: 2px solid var(--danger); margin: 40px; pointer-events:none;">
                <div style="position:absolute; top:-10px; left:-10px; width:20px; height:20px; border-top:2px solid red; border-left:2px solid red;"></div>
            </div>
        </div>
        <div class="panel" style="flex-grow: 1;">
            <div class="panel-header"><span>METADATA_EXTRACTOR</span></div>
            <div id="metadata-dump" style="padding:10px; font-size:12px; font-family:'Fira Code';"></div>
        </div>
    </div>

    <footer class="panel">
        <div>LATENCY: 14ms</div>
        <div id="packets-stat">PACKETS_CAPTURED: 0</div>
        <div>AUTHORIZED_USE_ONLY // IP_LOGGING_ACTIVE</div>
    </footer>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>

<script>
/* INITIALISATION ET CONFIGURATION 
*/
const firebaseConfig = {
    apiKey: "AIzaSyCpo7up--nfVG4zj_Zeu4kB7pr34ad4ceM",
    authDomain: "lycee-europe-private.firebaseapp.com",
    projectId: "lycee-europe-private",
    storageBucket: "lycee-europe-private.appspot.com",
    messagingSenderId: "259168134432",
    appId: "1:259168134432:web:470f5536d9305b4cf86345"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// --- AUDIO SYSTEM (GRANULAR SYNTHESIS) ---
const AudioEngine = {
    ctx: new (window.AudioContext || window.webkitAudioContext)(),
    
    playBip(freq, duration = 0.1, type = 'square') {
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
        gain.gain.setValueAtTime(0.02, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.00001, this.ctx.currentTime + duration);
        osc.connect(gain);
        gain.connect(this.ctx.destination);
        osc.start();
        osc.stop(this.ctx.currentTime + duration);
    },

    playStatic() {
        const bufferSize = 2 * this.ctx.sampleRate;
        const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
        const output = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) { output[i] = Math.random() * 2 - 1; }
        const whiteNoise = this.ctx.createBufferSource();
        whiteNoise.buffer = buffer;
        const gain = this.ctx.createGain();
        gain.gain.value = 0.005;
        whiteNoise.connect(gain);
        gain.connect(this.ctx.destination);
        whiteNoise.loop = true;
        whiteNoise.start();
    }
};

// --- RADAR ENGINE ---
const Radar = {
    canvas: document.getElementById('radar-canvas'),
    ctx: document.getElementById('radar-canvas').getContext('2d'),
    angle: 0,
    dots: [],

    init() {
        this.canvas.width = 380;
        this.canvas.height = 300;
        this.render();
    },

    render() {
        const { ctx, canvas } = this;
        const cx = canvas.width / 2;
        const cy = canvas.height / 2;

        ctx.fillStyle = 'rgba(0, 5, 0, 0.1)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Cercles
        ctx.strokeStyle = '#004400';
        for(let i=1; i<4; i++) {
            ctx.beginPath();
            ctx.arc(cx, cy, i * 40, 0, Math.PI * 2);
            ctx.stroke();
        }

        // Ligne de balayage
        const x2 = cx + Math.cos(this.angle) * 120;
        const y2 = cy + Math.sin(this.angle) * 120;
        ctx.strokeStyle = '#00ff41';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.lineTo(x2, y2);
        ctx.stroke();

        this.angle += 0.03;
        requestAnimationFrame(() => this.render());
    }
};

// --- CORE TERMINAL LOGIC ---
const Terminal = {
    el: document.getElementById('terminal-output'),
    
    print(text, type = 'info') {
        const div = document.createElement('div');
        div.className = `line ${type}`;
        div.style.color = type === 'error' ? 'var(--danger)' : (type === 'warn' ? 'var(--warning)' : 'var(--primary)');
        this.el.appendChild(div);
        
        let i = 0;
        const speed = 15;
        const typeChar = () => {
            if (i < text.length) {
                div.innerHTML += text.charAt(i);
                i++;
                setTimeout(typeChar, speed);
            } else {
                this.el.scrollTop = this.el.scrollHeight;
            }
        };
        typeChar();
        AudioEngine.playBip(400 + (Math.random()*100), 0.05, 'sine');
    },

    clear() { this.el.innerHTML = ''; }
};

// --- SYSTEM SIMULATION ---
async function startBreach() {
    Terminal.print(">> INITIALIZING UPLINK TO LOCAL NODE...");
    Terminal.print(">> BYPASSING FIREWALL [SSH_AUTH_FORCE]...");
    
    try {
        const info = await fetch('https://ipinfo.io/json?token=YOUR_TOKEN').then(r => r.json());
        Terminal.print(`>> TARGET_LOCATED: ${info.ip}`, 'warn');
        Terminal.print(`>> COORDINATES: ${info.loc}`);
        Terminal.print(`>> PROVIDER: ${info.org}`);
        
        document.getElementById('metadata-dump').innerHTML = `
            USER_AGENT: ${navigator.userAgent.substring(0, 50)}...<br>
            RESOLUTION: ${screen.width}x${screen.height}<br>
            CORES: ${navigator.hardwareConcurrency || 'UNDEF'}<br>
            MEMORY: ~${navigator.deviceMemory || '4'}GB<br>
            BATTERY: CHECKING...
        `;

        // Save to Firebase
        db.collection("access_logs").add({ ...info, time: new Date() });
    } catch(e) { Terminal.print(">> ANONYMIZER DETECTED. ENHANCING SIGNAL...", 'error'); }

    // Start Matrix Background Logs
    const matrix = document.getElementById('log-matrix');
    setInterval(() => {
        const line = document.createElement('div');
        line.textContent = Math.random().toString(16).repeat(3);
        matrix.prepend(line);
        if(matrix.children.length > 50) matrix.lastChild.remove();
    }, 100);

    // Audio static
    AudioEngine.playStatic();
}

// --- WEBCAM ---
async function initCam() {
    try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
        document.getElementById('webcam').srcObject = stream;
        Terminal.print(">> VISUAL_FEED_ESTABLISHED: BIOMETRIC_SCAN_ACTIVE", 'warn');
    } catch(e) {
        Terminal.print(">> CAMERA_ACCESS_DENIED: ESTIMATING_POSITION_VIA_WIFI_TRIANGULATION", 'error');
    }
}

// --- COMMAND HANDLER ---
document.getElementById('cmd-input').addEventListener('keydown', (e) => {
    if(e.key === 'Enter') {
        const cmd = e.target.value.toLowerCase().trim();
        e.target.value = '';
        Terminal.print(`root@fsociety:~# ${cmd}`);

        setTimeout(() => {
            if(cmd === 'help') {
                Terminal.print("SYSTEM COMMANDS: [SCAN] [EXFIL] [MAP] [WIPE] [STATUS]");
            } else if (cmd === 'scan') {
                Terminal.print("SCANNING LOCAL SUBNET...", 'warn');
                for(let i=0; i<5; i++) {
                    setTimeout(() => Terminal.print(`FOUND VULNERABILITY: 192.168.1.${Math.floor(Math.random()*255)}:80`), i*500);
                }
            } else if (cmd === 'exfil') {
                Terminal.print("EXTRACTING BROWSER_HISTORY...", 'error');
                Terminal.print("EXTRACTING COOKIES...", 'error');
                Terminal.print("DATA_DUMP_COMPLETE: CHECKING_REMOTE_SERVER.");
            } else {
                Terminal.print(`SYS_ERR: COMMAND '${cmd}' IS RESTRICTED OR INVALID.`, 'error');
                AudioEngine.playBip(150, 0.3, 'sawtooth');
            }
        }, 500);
    }
});

// --- INIT ---
window.onload = () => {
    Radar.init();
    startBreach();
    initCam();
    
    // Clock
    setInterval(() => {
        const d = new Date();
        document.getElementById('clock').textContent = d.toISOString().replace('T', ' ').replace('Z', '');
    }, 50);

    // Packet counter
    let pkts = 0;
    setInterval(() => {
        pkts += Math.floor(Math.random()*100);
        document.getElementById('packets-stat').textContent = `PACKETS_CAPTURED: ${pkts}`;
    }, 200);
};

</script>
</body>
</html>
